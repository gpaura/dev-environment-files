# Ranger configuration for VS Code-like sidebar
# Feature-rich file manager optimized for development

# Basic settings
set preview_files true
set preview_directories true
set collapse_preview true
set save_console_history true
set status_bar_on_top false
set draw_progress_bar_in_status_bar true
set draw_borders separators
set dirname_in_tabs true
set mouse_enabled true

# UI optimized for narrow sidebar
set column_ratios 1,1
set hidden_filter ^\.|\.(?:pyc|pyo|bak|swp)$|^lost\+found$|^__(pycache)__$
set show_hidden false
set confirm_on_delete multiple
set use_preview_script true
set automatically_count_files true
set open_all_images true
set vcs_aware true
set vcs_backend_git enabled

# Appearance
set colorscheme jungle
set unicode_ellipsis true
set show_cursor true
set scroll_offset 8

# Preview settings for development files
set preview_max_size 1048576
set preview_script ~/.config/ranger/scope.sh

# Sorting
set sort natural
set sort_reverse false
set sort_case_insensitive true
set sort_directories_first true

# Development-focused aliases
alias e edit
alias q quit
alias q! quitall
alias qa quitall
alias qall quitall
alias setl setlocal
alias filter scout -prts
alias find scout -aets
alias mark scout -mr
alias unmark scout -Mr

# Custom commands for development workflow
map DD shell mv %s ~/.Trash
map <C-f> fzf_select
map <C-l> redraw_window
map <C-r> reset
map <C-h> set show_hidden!

# Git integration
map gs shell git status
map gl shell git log --oneline -10
map gd shell git diff %s
map ga shell git add %s
map gc console shell git commit -m%space

# Quick navigation for development
map gd cd ~/dev
map gc cd ~/.config
map gh cd ~
map gt cd /tmp
map gw cd ~/workspace
map gn cd ~/notes

# File operations optimized for development
map E edit
map ee shell $EDITOR %s
map eo shell open %s
map r chain draw_possible_programs; console open_with%space
map i inspect

# Project management
map pp fzf_select
map pf console scout -ftsea%space

# Terminal integration
map <C-t> shell tmux new-window -c %d
map <C-n> shell $TERMINAL &

# Archive handling
map ex extract
map ec compress

# Development file templates
map nf console touch%space
map nd console mkdir%space
map nr console rename%space

# Quick file type navigation
map / console search%space
map n search_next
map N search_next forward=False
map ct search_next order=tag
map cs search_next order=size
map ci search_next order=mimetype
map cc search_next order=ctime
map cm search_next order=mtime
map ca search_next order=atime

# Custom functions for development

# FZF integration for quick file selection
cmd fzf_select
    command -v fzf > /dev/null || { echo "fzf not found" && return 1; }
    eval "$( \
        find -L . \( -path '*/\.*' -o -fstype 'dev' -o -fstype 'proc' \) -prune \
        -o -print 2> /dev/null | \
        sed 1d | \
        cut -b3- | \
        fzf +m --preview='head -50 {}')"

# Project finder
cmd project_find
    eval cd "$(find ~/dev -type d -name .git | head -20 | xargs dirname | fzf)"

# Quick edit with nvim
cmd edit_nvim
    $EDITOR "$@"

# Open in VS Code
cmd code
    code "$@"

# Extract archives
cmd extract
    case "$1" in
        *.tar.bz|*.tar.bz2|*.tbz|*.tbz2) tar xjvf "$1" ;;
        *.tar.gz|*.tgz) tar xzvf "$1" ;;
        *.tar.xz|*.txz) tar xJvf "$1" ;;
        *.zip) unzip "$1" ;;
        *.rar) unrar x "$1" ;;
        *.7z) 7z x "$1" ;;
        *) echo "extract: '$1' - unknown archive method" ;;
    esac

# Compress files
cmd compress
    case "$1" in
        *.tar.gz) tar czf "$1" "$@" ;;
        *.zip) zip -r "$1" "$@" ;;
        *) echo "compress: specify .tar.gz or .zip extension" ;;
    esac

# Development file inspection
cmd inspect
    case "$1" in
        *.json) jq . "$1" | less ;;
        *.yaml|*.yml) bat "$1" ;;
        *.md) glow -p "$1" ;;
        *.log) tail -f "$1" ;;
        *) file "$1" && echo && head -20 "$1" ;;
    esac